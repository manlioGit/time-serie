package com.github.manliogit.timeserie;

import static com.github.manliogit.stat.util.ListMatcher.closeTo;
import static java.util.Arrays.asList;
import static org.junit.Assert.assertThat;

import java.util.List;

import org.junit.Test;

public class SerieTest {

	@Test
	public void detrendMulti() {
		List<Double> y = asList(50.,61.,73.,84.,59.,72.,89.,100.,72.,93.,110.,126.,80.,100.,123.,140.);
		List<Double> expectedSeasonal = asList(1.07,1.19,0.8,0.92,1.09,1.16,0.79,0.96,1.09,1.22,0.76,0.92);
		
		assertThat(new Serie(y, 4).multiplicative().detrend(), closeTo(expectedSeasonal, 0.01));
	}
	
	@Test
	public void seasonMulti() {
		List<Double> y = asList(50.,61.,73.,84.,59.,72.,89.,100.,72.,93.,110.,126.,80.,100.,123.,140.);
		List<Double> expectedSeasonal = asList(0.78,0.93,1.08,1.19);
		
		assertThat(new Serie(y, 4).multiplicative().season(), closeTo(expectedSeasonal, 0.01));
	}
	
	@Test
	public void residualMulti() {
		List<Double> y = asList(50.,61.,73.,84.,59.,72.,89.,100.,72.,93.,110.,126.,80.,100.,123.,140.);
		List<Double> expectedResidual = asList(0.9896400024297665, 0.9978912049559723, 1.0200760588178088, 0.989268551319404, 1.006995915959131, 0.9770023754074381, 1.0108977222350162, 1.027513469540515, 1.0033640816111027, 1.0251064196365898, 0.9690262189471752, 0.9832179791400806);
		
		assertThat(new Serie(y, 4).multiplicative().residual(), closeTo(expectedResidual, 0.0001));
	}
	
	/***
	 * Monthly Airline Passenger Numbers 1949-1960
	 * The classic Box & Jenkins airline data. Monthly totals of international airline passengers, 1949 to 1960. 
	 * 
	 * see
	 * https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/AirPassengers.html
	 * https://anomaly.io/seasonal-trend-decomposition-in-r/
	 */
	@Test
	public void multiplicativeDecomposition() {
		List<Double> airPassengers = asList(112.,118.,132.,129.,121.,135.,148.,148.,136.,119.,104.,118.,115.,126.,141.,135.,125.,149.,170.,170.,158.,133.,114.,140.,145.,150.,178.,163.,172.,178.,199.,199.,184.,162.,146.,166.,171.,180.,193.,181.,183.,218.,230.,242.,209.,191.,172.,194.,196.,196.,236.,235.,229.,243.,264.,272.,237.,211.,180.,201.,204.,188.,235.,227.,234.,264.,302.,293.,259.,229.,203.,229.,242.,233.,267.,269.,270.,315.,364.,347.,312.,274.,237.,278.,284.,277.,317.,313.,318.,374.,413.,405.,355.,306.,271.,306.,315.,301.,356.,348.,355.,422.,465.,467.,404.,347.,305.,336.,340.,318.,362.,348.,363.,435.,491.,505.,404.,359.,310.,337.,360.,342.,406.,396.,420.,472.,548.,559.,463.,407.,362.,405.,417.,391.,419.,461.,472.,535.,622.,606.,508.,461.,390.,432.);
		
		List<Double> expectedMA = asList(126.7917,127.25,127.9583,128.5833,129.,129.75,131.25,133.0833,134.9167,136.4167,137.4167,138.75,140.9167,143.1667,145.7083,148.4167,151.5417,154.7083,157.125,159.5417,161.8333,164.125,166.6667,169.0833,171.25,173.5833,175.4583,176.8333,178.0417,180.1667,183.125,186.2083,189.0417,191.2917,193.5833,195.8333,198.0417,199.75,202.2083,206.25,210.4167,213.375,215.8333,218.5,220.9167,222.9167,224.0833,224.7083,225.3333,225.3333,224.9583,224.5833,224.4583,225.5417,228.,230.4583,232.25,233.9167,235.625,237.75,240.5,243.9583,247.1667,250.25,253.5,257.125,261.8333,266.6667,271.125,275.2083,278.5,281.9583,285.75,289.3333,293.25,297.1667,301.,305.4583,309.9583,314.4167,318.625,321.75,324.5,327.0833,329.5417,331.8333,334.4583,337.5417,340.5417,344.0833,348.25,353.,357.625,361.375,364.5,367.1667,369.4583,371.2083,372.1667,372.4167,372.75,373.625,375.25,377.9167,379.5,380.,380.7083,380.9583,381.8333,383.6667,386.5,390.3333,394.7083,398.625,402.5417,407.1667,411.875,416.3333,420.5,425.5,430.7083,435.125,437.7083,440.9583,445.8333,450.625,456.3333,461.375,465.2083,469.3333,472.75,475.0417);
		List<Double> expectedDetrend = asList(1.167269,1.163065,1.062846,0.9254699,0.8062016,0.9094412,0.8761905,0.9467752,1.04509,0.9896151,0.9096422,1.073874,1.206387,1.187427,1.084358,0.8961258,0.7522684,0.9049286,0.9228321,0.9401933,1.099897,0.9931455,1.032,1.052735,1.162044,1.146423,1.048682,0.9161169,0.8200328,0.9213691,0.9337884,0.9666592,1.020939,0.9461991,0.9453293,1.113191,1.161372,1.211514,1.033587,0.9260606,0.8174257,0.9091974,0.9081081,0.8970252,1.068276,1.054206,1.021941,1.081402,1.171598,1.207101,1.053528,0.9395176,0.8019306,0.8911879,0.8947368,0.8157657,1.011841,0.9704311,0.9931034,1.11041,1.255717,1.201025,1.047876,0.9150849,0.800789,0.8906174,0.9242521,0.87375,0.9847856,0.9774413,0.9694794,1.117186,1.273841,1.199309,1.063939,0.9220415,0.7873754,0.9101078,0.9162522,0.8809966,0.9949,0.972805,0.9799692,1.143439,1.253256,1.220492,1.061418,0.9065547,0.795791,0.8893194,0.9045226,0.8526912,0.9954561,0.9629886,0.9739369,1.149342,1.258599,1.258054,1.085535,0.9317521,0.8182428,0.8992974,0.9060626,0.8414553,0.9538867,0.9157895,0.9534858,1.141857,1.285901,1.316247,1.045278,0.9197267,0.7853901,0.8454061,0.8943174,0.8399509,0.985736,0.9511609,0.9988109,1.109283,1.272323,1.284688,1.057782,0.9229897,0.8119626,0.8987517,0.9138057,0.8474668,0.9006717,0.9822443,0.9984135,1.126217);
 		List<Double> expectedSeason = asList(0.9086244,0.8820663,1.005589,0.9741842,0.9796465,1.110813,1.224391,1.217759,1.058621,0.9201309,0.7997645,0.8972386);
		List<Double> expectedResidual = asList(0.9533463,0.9550865,1.003991,1.005802,1.008049,1.0136,0.9643044,1.073361,1.039281,1.01584,0.9285412,0.9667463,0.985295,0.9750924,1.024312,0.9739111,0.9406123,1.008571,1.015637,1.065899,1.093784,1.019464,1.053441,0.9477165,0.9490786,0.9414209,0.9906115,0.9956375,1.025343,1.026894,1.027695,1.095903,1.015265,0.9712733,0.9649698,1.002142,0.9485298,0.9948724,0.9763528,1.006444,1.022083,1.013329,0.9994318,1.016959,1.062339,1.082142,1.043173,0.9735233,0.9568816,0.9912478,0.9951896,1.021069,1.002708,0.9932563,0.9847158,0.9248349,1.006217,0.9961474,1.013736,0.9996377,1.025585,0.9862585,0.9898501,0.994516,1.001281,0.9926205,1.017199,0.9905718,0.9793123,1.003343,0.9896216,1.005738,1.040387,0.9848493,1.005023,1.002076,0.984509,1.014343,1.008395,0.9987872,0.9893704,0.9985842,1.000329,1.029372,1.023574,1.002245,1.002642,0.9852454,0.9950316,0.9911739,0.9954857,0.9666974,0.9899235,0.9885077,0.9941717,1.034686,1.027939,1.033089,1.025424,1.01263,1.023105,1.002295,0.9971806,0.9539593,0.9485851,0.9400578,0.9732958,1.027948,1.050237,1.080877,0.9873961,0.9995607,0.9820266,0.9422311,0.9842542,0.9522537,0.9802574,0.9763666,1.019563,0.9986232,1.039147,1.054961,0.9992076,1.003107,1.015252,1.001686,1.005702,0.9607745,0.8956659,1.008274,1.019157,1.013868);
 		
		Serie serie = new Serie(airPassengers, 12).multiplicative();
		assertThat(serie.trend(), closeTo(expectedMA, 0.0001));
		assertThat(serie.detrend(), closeTo(expectedDetrend, 0.0001));
		assertThat(serie.season(), closeTo(expectedSeason, 0.0001));
		assertThat(serie.residual(), closeTo(expectedResidual, 0.0001));
	}
	
	/***
	 *  Total quarterly beer production in Australia (in megalitres) from 1956:Q1 to 2008:Q3. 
	 * 
	 *  see
	 *  https://www.rdocumentation.org/packages/fpp/versions/0.5/topics/ausbeer
	 *  https://anomaly.io/seasonal-trend-decomposition-in-r/
	 */
	@Test
	public void additiveDecomposition() {
		List<Double> ausBeer = asList(236.,320.,272.,233.,237.,313.,261.,227.,250.,314.,286.,227.,260.,311.,295.,233.,257.,339.,279.,250.,270.,346.,294.,255.,278.,363.,313.,273.,300.,370.,331.,288.,306.,386.,335.,288.,308.,402.,353.,316.,325.,405.,393.,319.,327.,442.,383.,332.,361.,446.,387.,357.,374.,466.,410.,370.,379.,487.,419.,378.,393.,506.,458.,387.);
		
		List<Double> expectedMA = asList(265.375,264.625,262.375,260.25,261.125,262.875,266.125,269.25,270.5,271.375,272.125,274.,274.375,277.5,279.,279.125,282.875,285.375,288.125,290.625,292.25,295.375,299.875,304.5,309.5,313.125,316.25,320.375,323.,325.75,328.25,328.75,329.,331.25,335.5,341.25,346.875,349.375,354.75,360.125,360.75,365.625,369.,369.375,375.25,380.,381.,384.625,389.375,393.5,398.875,403.375,405.625,408.875,412.625,414.75,417.5,421.625,428.875,434.875);
		List<Double> expectedDetrend = asList(6.625,-31.625,-25.375,52.75,-0.125,-35.875,-16.125,44.75,15.5,-44.375,-12.125,37.,20.625,-44.5,-22.,59.875,-3.875,-35.375,-18.125,55.375,1.75,-40.375,-21.875,58.5,3.5,-40.125,-16.25,49.625,8.,-37.75,-22.25,57.25,6.,-43.25,-27.5,60.75,6.125,-33.375,-29.75,44.875,32.25,-46.625,-42.,72.625,7.75,-48.,-20.,61.375,-2.375,-36.5,-24.875,62.625,4.375,-38.875,-33.625,72.25,1.5,-43.625,-35.875,71.125);
		List<Double> expectedSeason = asList(-24.51667, 57.38333, 7.17500, -40.01667);
		List<Double> expectedResidual = asList(-0.55,8.391667,-0.8583333,-4.633333,-7.3,4.141667,8.391667,-12.63333,8.325,-4.358333,12.39167,-20.38333,13.45,-4.483333,2.516667,2.491667,-11.05,4.641667,6.391667,-2.008333,-5.425,-0.3583333,2.641667,1.116667,-3.675,-0.1083333,8.266667,-7.758333,0.825,2.266667,2.266667,-0.1333333,-1.175,-3.233333,-2.983333,3.366667,-1.05,6.641667,-5.233333,-12.50833,25.075,-6.608333,-17.48333,15.24167,0.575,-7.983333,4.516667,3.991667,-9.55,3.516667,-0.3583333,5.241667,-2.8,1.141667,-9.108333,14.86667,-5.675,-3.608333,-11.35833,13.74167);
		
		Serie serie = new Serie(ausBeer, 4);

		assertThat(serie.trend(), closeTo(expectedMA, 0.0001));
		assertThat(serie.detrend(), closeTo(expectedDetrend, 0.0001));
		assertThat(serie.season(), closeTo(expectedSeason, 0.0001));
		assertThat(serie.residual(), closeTo(expectedResidual, 0.0001));
	}
	
	/***
	 *  see
	 *  https://anomaly.io/anomaly-detection-moving-median-decomposition/
	 */
	@Test
	public void multiplicativeDecompositionWithMovingMedian() {
		List<Double> webTraffic = asList(32.,27.,30.,25.,14.,41.,32.,48.,22.,26.,23.,27.,40.,42.,46.,49.,26.,15.,20.,33.,32.,46.,32.,38.,27.,31.,65.,33.,42.,98.92576,37.,20.,23.,37.,30.,16.,33.,28.,37.,18.,38.,32.,16.,31.,34.,25.,27.,47.,48.,43.,44.,46.,25.,31.,40.,45.,46.,48.,33.,29.,26.,43.,71.,43.,51.,34.,47.59135,30.,47.,49.,49.,48.,83.65116,36.,33.,45.,53.,48.,30.,68.82951,20.,18.,76.18019,47.,35.,52.,50.,27.,27.,55.,58.,51.,51.,52.,37.,36.,44.,51.,122.5844,48.,54.,35.,37.,60.,54.,57.,40.,35.,22.,34.,50.,64.,45.,50.,59.,29.,23.,60.,56.,58.,53.,163.726,37.,28.,61.,74.,36.,51.,52.,30.,31.,59.,73.,64.,82.,63.,37.,53.,89.,89.,84.,96.,71.,55.,63.,106.,76.,102.,113.,59.,49.,50.,71.,96.,99.,100.,71.,58.,46.,83.,66.,200.8601,61.,67.,58.,46.,83.,76.,200.8601,67.,74.,49.,48.,74.,89.,86.,149.7946,78.,49.,61.,81.,98.,230.2393,76.,65.,46.,37.,89.,105.,87.,77.,61.,101.512,48.,81.,75.,91.,91.,77.,48.,29.,85.,102.,95.,94.,78.,46.,58.,88.,107.,114.,71.,82.,49.,45.,92.,99.,79.,180.7076,86.,49.,44.,77.,94.,100.,91.,70.,51.,37.,88.,90.,105.,89.,76.,48.,88.695,91.,101.,254.2059,75.,93.,49.,36.,92.,75.,122.,85.,86.,61.,45.,90.,101.,86.,77.,94.,45.,45.,70.,266.3343,103.,105.,63.,26.,48.,86.,80.,86.,73.,71.,42.,58.,92.,86.,90.,81.,76.,74.,50.,77.,83.,79.,76.,57.,32.,46.,61.,72.,91.,79.,63.,38.,73.71621,74.,85.,64.,86.,75.,43.,43.,73.,84.,84.,71.,68.,39.,66.40744,74.,76.,73.,183.5646,70.,46.,44.,80.,81.,64.,62.,63.,38.,40.,192.1799,80.,73.,78.,67.,35.,51.,68.,67.,71.,63.,54.,54.,46.,90.,84.,61.,69.,48.,35.,47.,56.,82.,75.,64.,66.,43.,91.23514,84.,72.,80.,166.5367,61.,39.,54.,80.,73.,90.,69.,59.,44.,117.2549,84.,100.,94.,87.,86.,60.,54.,97.,86.,85.,78.,52.,67.,41.,75.,79.,68.,80.,75.,49.,42.,236.1937,67.,76.,260.2583,83.,50.,38.,82.,68.,76.,71.,52.,27.,73.71621,53.,53.,48.,35.,40.,28.,32.,60.,56.,49.,32.,61.,43.,45.,73.,59.,65.,76.,60.,42.,32.,64.,64.,63.,87.,75.,45.,49.,84.,99.,160.9233,72.,70.,45.,53.,81.,79.,94.,78.,85.,42.,40.,71.,77.,69.,60.,61.,45.,36.,127.9528,85.,84.,79.,55.,36.,42.,105.,56.,82.,68.,81.,36.,52.,88.,98.,91.,86.,76.,119.9147,39.,79.,75.,83.,76.,73.,35.,114.6051,58.,77.,82.,82.,62.,41.,48.,65.,80.,77.,87.,71.,38.,35.,79.,87.,89.,87.,57.,42.,40.,71.,82.,200.8601,82.,65.,106.7174,59.,74.,74.,84.,79.,72.,48.,73.71621,81.,98.,79.,71.,79.,47.,50.,81.,88.,96.,80.,88.,32.,46.,82.,101.,80.,69.,0.,40.,48.,221.3559,104.,91.,114.,110.,66.,59.,100.,100.,96.,92.,99.,117.2549,62.,66.,119.,107.,93.,102.,46.,49.,99.,117.,110.,107.,100.,42.,42.,107.,101.,109.,102.,125.,61.,52.,97.,108.,96.,100.,96.,46.,101.512,80.,96.,115.,121.,114.,44.,43.,111.,92.,257.2292,99.,93.,42.,48.,91.,127.,96.,109.,81.,37.,93.78712,113.,127.,376.1436,127.,97.,44.,36.,84.,92.,90.,110.,88.,44.,44.,93.,100.,96.,101.,82.,51.,42.,107.,248.1774,79.,117.,103.,46.,36.,104.,120.,101.,97.,82.,43.,47.,95.,137.,356.8829,106.,84.,52.,50.,106.,132.,98.,97.,109.,64.,44.,103.,113.,111.,107.,95.,50.,53.,124.,363.2844,136.,144.,97.,59.,62.,251.1886,132.,123.,103.,86.,46.,48.,102.,132.,112.,125.,111.,51.,59.,116.,118.,146.,127.,109.,55.,40.,89.,99.,272.4335,105.,74.,39.,33.,113.,114.,102.,116.,105.,60.,70.,119.,312.6205,126.,138.,115.,84.,66.,132.,148.,114.,120.,122.,59.,65.,129.,133.,151.,141.,158.,68.,66.,171.,166.,171.,160.,138.,64.,40.,107.,138.);
		
		List<Double> expectedMM = asList(30.,30.,30.,26.,26.,27.,27.,27.,27.,40.,40.,40.,40.,33.,32.,32.,32.,32.,32.,32.,32.,33.,33.,38.,37.,37.,37.,37.,37.,30.,30.,28.,30.,30.,30.,32.,32.,31.,32.,31.,31.,31.,31.,34.,43.,44.,44.,44.,43.,43.,44.,45.,40.,40.,40.,43.,43.,43.,43.,43.,43.,43.,47.,47.,47.59135,47.59135,48.,48.,48.,48.,48.,48.,45.,45.,45.,45.,48.,47.,35.,47.,47.,47.,47.,47.,50.,51.,51.,51.,51.,51.,51.,51.,51.,48.,48.,48.,48.,51.,54.,54.,54.,40.,40.,40.,40.,40.,40.,45.,50.,50.,50.,50.,50.,56.,56.,56.,56.,56.,56.,58.,53.,51.,51.,51.,51.,51.,51.,52.,59.,63.,63.,63.,64.,64.,82.,84.,84.,84.,84.,84.,76.,76.,76.,76.,76.,76.,71.,71.,71.,71.,71.,71.,71.,83.,71.,71.,66.,66.,66.,66.,66.,67.,67.,67.,74.,74.,74.,74.,74.,74.,74.,78.,78.,78.,81.,81.,81.,78.,76.,76.,76.,76.,76.,76.,77.,77.,87.,87.,81.,77.,77.,81.,81.,77.,77.,77.,85.,85.,85.,85.,85.,85.,88.,88.,88.,78.,82.,82.,82.,82.,82.,79.,82.,86.,86.,86.,79.,79.,86.,86.,77.,77.,77.,88.,88.,88.,88.,88.,88.,88.695,89.,89.,89.,88.695,91.,91.,91.,92.,75.,75.,85.,85.,85.,85.,85.,86.,86.,86.,86.,86.,86.,77.,77.,77.,94.,70.,70.,70.,86.,80.,80.,73.,73.,73.,73.,73.,73.,73.,81.,81.,81.,81.,77.,77.,77.,76.,76.,76.,76.,61.,61.,61.,61.,63.,63.,72.,73.71621,74.,73.71621,73.71621,74.,74.,74.,73.,73.,75.,73.,71.,71.,71.,71.,71.,71.,73.,73.,73.,73.,73.,73.,70.,64.,63.,63.,63.,63.,63.,63.,73.,73.,73.,73.,68.,67.,67.,67.,63.,63.,63.,63.,63.,61.,61.,61.,61.,61.,56.,56.,56.,56.,64.,64.,66.,75.,72.,72.,80.,80.,80.,72.,72.,73.,73.,69.,69.,69.,73.,73.,84.,84.,87.,87.,87.,86.,87.,86.,86.,85.,78.,78.,78.,75.,75.,68.,68.,75.,75.,75.,75.,68.,75.,75.,76.,76.,76.,76.,76.,76.,71.,68.,68.,71.,68.,53.,53.,52.,48.,48.,40.,40.,40.,40.,40.,49.,49.,49.,49.,49.,59.,61.,60.,60.,60.,60.,64.,63.,63.,64.,64.,64.,64.,75.,84.,75.,72.,72.,72.,72.,72.,72.,78.,79.,79.,79.,78.,77.,71.,69.,61.,61.,61.,61.,61.,61.,79.,79.,79.,79.,79.,56.,56.,56.,68.,68.,68.,68.,81.,81.,86.,86.,88.,88.,86.,79.,79.,76.,76.,75.,76.,75.,76.,76.,77.,77.,77.,62.,65.,65.,65.,65.,71.,71.,71.,77.,77.,79.,79.,79.,79.,79.,71.,71.,71.,71.,71.,82.,82.,82.,74.,74.,74.,74.,74.,74.,74.,79.,79.,73.71621,79.,79.,79.,79.,79.,79.,80.,81.,81.,81.,82.,82.,80.,80.,69.,69.,69.,69.,69.,69.,91.,104.,104.,104.,100.,100.,100.,96.,96.,99.,99.,96.,96.,99.,99.,102.,93.,93.,99.,99.,99.,102.,100.,100.,100.,107.,101.,101.,101.,102.,102.,102.,101.,102.,97.,97.,96.,96.,97.,96.,96.,96.,96.,101.512,101.512,96.,111.,111.,111.,99.,93.,93.,93.,92.,93.,93.,93.,91.,91.,93.78712,96.,96.,109.,113.,113.,113.,113.,97.,92.,90.,90.,88.,88.,88.,90.,90.,93.,93.,93.,93.,93.,96.,96.,82.,82.,103.,103.,103.,103.,103.,103.,101.,97.,97.,97.,95.,95.,95.,95.,95.,95.,95.,106.,106.,98.,97.,98.,98.,98.,98.,98.,103.,107.,103.,103.,103.,107.,107.,107.,124.,124.,124.,124.,136.,132.,123.,103.,103.,103.,103.,102.,102.,102.,102.,111.,111.,111.,112.,112.,116.,116.,116.,116.,116.,109.,99.,99.,99.,89.,89.,89.,99.,105.,102.,102.,105.,105.,105.,105.,105.,116.,119.,119.,119.,119.,126.,126.,115.,115.,120.,120.,120.,120.,120.,122.,129.,133.,133.,133.,141.,151.,158.,160.,160.,160.,160.,138.,138.);
		List<Double> expectedDetrend = asList(0.8333333,0.4666667,1.3666667,1.2307692,1.8461538,0.8148148,0.9629630,0.8518519,1.0000000,1.0000000,1.0500000,1.1500000,1.2250000,0.7878788,0.4687500,0.6250000,1.0312500,1.0000000,1.4375000,1.0000000,1.1875000,0.8181818,0.9393939,1.7105263,0.8918919,1.1351351,2.6736692,1.0000000,0.5405405,0.7666667,1.2333333,1.0714286,0.5333333,1.1000000,0.9333333,1.1562500,0.5625000,1.2258065,1.0000000,0.5161290,1.0000000,1.0967742,0.8064516,0.7941176,1.0930233,1.0909091,0.9772727,1.0000000,1.0697674,0.5813953,0.7045455,0.8888889,1.1250000,1.1500000,1.2000000,0.7674419,0.6744186,0.6046512,1.0000000,1.6511628,1.0000000,1.1860465,0.7234043,1.0125819,0.6303667,0.9875745,1.0208333,1.0208333,1.0000000,1.7427326,0.7500000,0.6875000,1.0000000,1.1777778,1.0666667,0.6666667,1.4339482,0.4255319,0.5142857,1.6208552,1.0000000,0.7446809,1.1063830,1.0638298,0.5400000,0.5294118,1.0784314,1.1372549,1.0000000,1.0000000,1.0196078,0.7254902,0.7058824,0.9166667,1.0625000,2.5538418,1.0000000,1.0588235,0.6481481,0.6851852,1.1111111,1.3500000,1.4250000,1.0000000,0.8750000,0.5500000,0.8500000,1.1111111,1.2800000,0.9000000,1.0000000,1.1800000,0.5800000,0.4107143,1.0714286,1.0000000,1.0357143,0.9464286,2.9236785,0.6379310,0.5283019,1.1960784,1.4509804,0.7058824,1.0000000,1.0196078,0.5882353,0.5961538,1.0000000,1.1587302,1.0158730,1.3015873,0.9843750,0.5781250,0.6463415,1.0595238,1.0595238,1.0000000,1.1428571,0.8452381,0.7236842,0.8289474,1.3947368,1.0000000,1.3421053,1.4868421,0.8309859,0.6901408,0.7042254,1.0000000,1.3521127,1.3943662,1.4084507,0.8554217,0.8169014,0.6478873,1.2575758,1.0000000,3.0433351,0.9242424,1.0151515,0.8656716,0.6865672,1.2388060,1.0270270,2.7143259,0.9054054,1.0000000,0.6621622,0.6486486,1.0000000,1.1410256,1.1025641,1.9204430,0.9629630,0.6049383,0.7530864,1.0384615,1.2894737,3.0294650,1.0000000,0.8552632,0.6052632,0.4868421,1.1558442,1.3636364,1.0000000,0.8850575,0.7530864,1.3183378,0.6233766,1.0000000,0.9259259,1.1818182,1.1818182,1.0000000,0.5647059,0.3411765,1.0000000,1.2000000,1.1176471,1.1058824,0.8863636,0.5227273,0.6590909,1.1282051,1.3048780,1.3902439,0.8658537,1.0000000,0.5975610,0.5696203,1.1219512,1.1511628,0.9186047,2.1012506,1.0886076,0.6202532,0.5116279,0.8953488,1.2207792,1.2987013,1.1818182,0.7954545,0.5795455,0.4204545,1.0000000,1.0227273,1.1931818,1.0034387,0.8539326,0.5393258,0.9965731,1.0259879,1.1098901,2.7934716,0.8241758,1.0108696,0.6533333,0.4800000,1.0823529,0.8823529,1.4352941,1.0000000,1.0117647,0.7093023,0.5232558,1.0465116,1.1744186,1.0000000,0.8953488,1.2207792,0.5844156,0.5844156,0.7446809,3.8047762,1.4714286,1.5000000,0.7325581,0.3250000,0.6000000,1.1780822,1.0958904,1.1780822,1.0000000,0.9726027,0.5753425,0.7945205,1.1358025,1.0617284,1.1111111,1.0000000,0.9870130,0.9610390,0.6493506,1.0131579,1.0921053,1.0394737,1.0000000,0.9344262,0.5245902,0.7540984,1.0000000,1.1428571,1.4444444,1.0972222,0.8546288,0.5135135,1.0000000,1.0038498,1.1486486,0.8648649,1.1621622,1.0273973,0.5890411,0.5733333,1.0000000,1.1830986,1.1830986,1.0000000,0.9577465,0.5492958,0.9353160,1.0136986,1.0410959,1.0000000,2.5145832,0.9589041,0.6301370,0.6285714,1.2500000,1.2857143,1.0158730,0.9841270,1.0000000,0.6031746,0.6349206,2.6326015,1.0958904,1.0000000,1.0684932,0.9852941,0.5223881,0.7611940,1.0149254,1.0634921,1.1269841,1.0000000,0.8571429,0.8571429,0.7540984,1.4754098,1.3770492,1.0000000,1.1311475,0.8571429,0.6250000,0.8392857,1.0000000,1.2812500,1.1718750,0.9696970,0.8800000,0.5972222,1.2671547,1.0500000,0.9000000,1.0000000,2.3130101,0.8472222,0.5342466,0.7397260,1.1594203,1.0579710,1.3043478,0.9452055,0.8082192,0.5238095,1.3958918,0.9655172,1.1494253,1.0804598,1.0116279,0.9885057,0.6976744,0.6279070,1.1411765,1.1025641,1.0897436,1.0000000,0.6933333,0.8933333,0.6029412,1.1029412,1.0533333,0.9066667,1.0666667,1.0000000,0.7205882,0.5600000,3.1492495,0.8815789,1.0000000,3.4244520,1.0921053,0.6578947,0.5000000,1.1549296,1.0000000,1.1176471,1.0000000,0.7647059,0.5094340,1.3908719,1.0192308,1.1041667,1.0000000,0.8750000,1.0000000,0.7000000,0.8000000,1.5000000,1.1428571,1.0000000,0.6530612,1.2448980,0.8775510,0.7627119,1.1967213,0.9833333,1.0833333,1.2666667,1.0000000,0.6562500,0.5079365,1.0158730,1.0000000,0.9843750,1.3593750,1.1718750,0.6000000,0.5833333,1.1200000,1.3750000,2.2350457,1.0000000,0.9722222,0.6250000,0.7361111,1.0384615,1.0000000,1.1898734,0.9873418,1.0897436,0.5454545,0.5633803,1.0289855,1.2622951,1.1311475,0.9836066,1.0000000,0.7377049,0.5901639,1.6196558,1.0759494,1.0632911,1.0000000,0.6962025,0.6428571,0.7500000,1.8750000,0.8235294,1.2058824,1.0000000,1.1911765,0.4444444,0.6419753,1.0232558,1.1395349,1.0340909,0.9772727,0.8837209,1.5179079,0.4936709,1.0394737,0.9868421,1.1066667,1.0000000,0.9733333,0.4605263,1.5079621,0.7532468,1.0000000,1.0649351,1.3225806,0.9538462,0.6307692,0.7384615,1.0000000,1.1267606,1.0845070,1.2253521,0.9220779,0.4935065,0.4430380,1.0000000,1.1012658,1.1265823,1.1012658,0.8028169,0.5915493,0.5633803,1.0000000,1.1549296,2.4495136,1.0000000,0.7926829,1.4421272,0.7972973,1.0000000,1.0000000,1.1351351,1.0675676,0.9729730,0.6075949,0.9331166,1.0988085,1.2405063,1.0000000,0.8987342,1.0000000,0.5949367,0.6329114,1.0125000,1.0864198,1.1851852,0.9876543,1.0731707,0.3902439,0.5750000,1.0250000,1.4637681,1.1594203,1.0000000,0.0000000,0.5797101,0.6956522,2.4324819,1.0000000,0.8750000,1.0961538,1.1000000,0.6600000,0.5900000,1.0416667,1.0416667,0.9696970,0.9292929,1.0312500,1.2214053,0.6262626,0.6666667,1.1666667,1.1505376,1.0000000,1.0303030,0.4646465,0.4949495,0.9705882,1.1700000,1.1000000,1.0700000,0.9345794,0.4158416,0.4158416,1.0594059,0.9901961,1.0686275,1.0000000,1.2376238,0.5980392,0.5360825,1.0000000,1.1250000,1.0000000,1.0309278,1.0000000,0.4791667,1.0574168,0.8333333,0.9457009,1.1328709,1.2604167,1.0270270,0.3963964,0.3873874,1.1212121,0.9892473,2.7659050,1.0645161,1.0108696,0.4516129,0.5161290,0.9784946,1.3956044,1.0549451,1.1622065,0.8437500,0.3854167,0.8604323,1.0000000,1.1238938,3.3287042,1.1238938,1.0000000,0.4782609,0.4000000,0.9333333,1.0454545,1.0227273,1.2500000,0.9777778,0.4888889,0.4731183,1.0000000,1.0752688,1.0322581,1.0860215,0.8541667,0.5312500,0.5121951,1.3048780,2.4094893,0.7669903,1.1359223,1.0000000,0.4466019,0.3495146,1.0297030,1.2371134,1.0412371,1.0000000,0.8631579,0.4526316,0.4947368,1.0000000,1.4421053,3.7566623,1.1157895,0.7924528,0.4905660,0.5102041,1.0927835,1.3469388,1.0000000,0.9897959,1.1122449,0.6530612,0.4271845,0.9626168,1.0970874,1.0776699,1.0388350,0.8878505,0.4672897,0.4953271,1.0000000,2.9297125,1.0967742,1.1612903,0.7132353,0.4469697,0.5040650,2.4387247,1.2815534,1.1941748,1.0000000,0.8431373,0.4509804,0.4705882,1.0000000,1.1891892,1.0090090,1.1261261,0.9910714,0.4553571,0.5086207,1.0000000,1.0172414,1.2586207,1.0948276,1.0000000,0.5555556,0.4040404,0.8989899,1.1123596,3.0610507,1.1797753,0.7474747,0.3714286,0.3235294,1.1078431,1.0857143,0.9714286,1.1047619,1.0000000,0.5714286,0.6034483,1.0000000,2.6270633,1.0588235,1.1596639,0.9126984,0.6666667,0.5739130,1.1478261,1.2333333,0.9500000,1.0000000,1.0166667,0.4916667,0.5327869,1.0000000,1.0000000,1.1353383,1.0601504,1.1205674,0.4503311,0.4177215,1.0687500,1.0375000,1.0687500,1.0000000,1.0000000,0.4637681);
		List<Double> expectedSeason = asList(1.1967439, 1.2769776, 1.1367740, 0.9786810, 0.6308613, 0.6486807, 1.1430001);
		List<Double> expectedResidual = asList(0.8516680764003858, 0.7325475746851645, 2.0954761586786432, 1.0754692501660843, 1.5438233025661638, 0.637052123277434, 0.8453752341052131, 0.8705940336537277, 1.5697448028967813, 1.533275238057544, 0.9175097040479405, 0.9616732655568395, 0.9577499535182332, 0.6916706460860834, 0.479063292975217, 0.9810905018104883, 1.5811900892468422, 0.8738187657599434, 1.2020915819460494, 0.7818366967495781, 1.042493978596092, 0.836183202284015, 1.4746087542363702, 2.622707644045799, 0.7793518721642739, 0.9492427063075736, 2.0903726870767985, 0.8778896661861828, 0.5524333468543042, 1.2034710155541988, 1.8910394602709708, 0.9362343918856537, 0.445993398519114, 0.8600203664245359, 0.8193636884404374, 1.1816894560055353, 0.8829814516294394, 1.8794986789092476, 0.8738187657599434, 0.43160651469591677, 0.7818366967495781, 0.9628467306558135, 0.8241949126455346, 1.2465620493592087, 1.6759054927605714, 0.9532568353744837, 0.8172322217182628, 0.7818366967495781, 0.9391377824317304, 0.5941870300467808, 1.1059565656772776, 1.3629113227178171, 0.9830461114799364, 0.9616732655568395, 0.9382040360994938, 0.6737292787010241, 0.6892569548542656, 0.9491480203561933, 1.533275238057544, 1.4428170318361857, 0.8362376222233388, 0.9272946868425229, 0.6350691202197919, 1.034860429986319, 0.9895147770950695, 1.514223408008064, 0.8920233233799423, 0.8536592393529916, 0.781836696749578, 1.529926852676812, 0.7665012687603472, 1.0791995519915372, 1.533275238057544, 1.0291643241172668, 0.8919867970382279, 0.5212244644997188, 1.2588482407845527, 0.4348943368853033, 0.8072973272040589, 2.4852169990961475, 0.8738187657599434, 0.6227301442088692, 0.8650108134250651, 0.9339251767938116, 0.5518809135074499, 0.8310413662394724, 1.653532119473822, 0.993754674785818, 0.8362376222233388, 0.7818366967495781, 0.8951031890525786, 0.7414522076897476, 1.1080551549859634, 1.4055023015527488, 0.92843243861994, 2.1356184828682214, 0.781836696749578, 0.9295302347853701, 0.6624085038669667, 1.075565883466313, 1.7036391533972712, 1.1796553337759237, 1.1916386116682578, 0.7818366967495781, 0.76815345791291, 0.5621009304242546, 1.334283082462264, 1.7036391533972712, 1.1184880201727276, 0.7526138600010048, 0.7818366967495781, 1.0359098060996956, 0.5927609811746685, 0.6447166154754638, 1.6427948979187974, 0.8738187657599434, 0.866103251588458, 0.7399525879951364, 2.5666672051071244, 0.6519665964168471, 0.8292991411530165, 1.8339174415982389, 1.2678938954163885, 0.590285380392945, 0.7818366967495781, 0.8951031890525786, 0.6011774656943899, 0.9358094017269272, 1.5332752380575438, 1.0125201571504105, 0.8495112352745028, 1.0176287164042128, 0.8641726401520238, 0.5908447280027677, 1.0145911530918221, 1.624541621275255, 0.9258317875313686, 0.8362376222233388, 0.8935276534280893, 0.7420257892764165, 0.739606487400335, 1.3012358234539108, 2.138515463606575, 0.8738187657599434, 1.1223189140365861, 1.1624677201671358, 0.7295139479575322, 0.705325111159756, 1.105454086547029, 1.533275238057544, 1.1815014297599236, 1.1660214732409935, 1.1011784461261662, 0.7509658590267347, 0.8348746213727725, 1.0170177596232666, 1.928209769072366, 0.8738187657599434, 2.5449510973263942, 0.7226066439655192, 0.8911910247647613, 0.8847178823502514, 1.0777352378097305, 1.8994305187877039, 0.8974354891588608, 2.269821248966784, 0.7078791713813748, 0.8778896661861828, 0.6767308498965227, 1.0182128451222363, 1.533275238057544, 0.9970496173414738, 0.9220055834770146, 1.5014732724990303, 0.8453752341052132, 0.6182479369425022, 1.1821534935395512, 1.592247362598219, 1.1267663032167692, 2.5333521680837623, 0.7818366967495781, 0.7508266881855511, 0.6185799712802801, 0.7642178645681699, 1.7722272232093692, 1.1915710442181047, 0.8362376222233388, 0.691970409766868, 0.6611267856463846, 1.3473433211151578, 0.9785422147927987, 1.533275238057544, 0.8090914497777254, 0.9882808262639458, 0.9239888234313195, 0.8778896661861828, 0.5771303670666144, 0.5355599915765489, 1.533275238057544, 1.0485825189119322, 0.9346185189554962, 0.8646194058171804, 0.7781294768468439, 0.5342281570147874, 1.0346045291819694, 1.7298489865264601, 1.140226926052609, 1.1625742552861051, 0.676956164258781, 0.8778896661861829, 0.6107083279553985, 0.8941584320298122, 1.7202600231865128, 1.005907648956214, 0.7681717692516716, 1.6428352681574894, 0.9556773581267306, 0.6338997834473756, 0.803125247993702, 1.3728162015166383, 1.0667397919666843, 1.086022886004336, 0.9239888234313195, 0.6983213253753727, 0.5922964349511773, 0.6600063375816012, 1.533275238057544, 0.8936782831635784, 0.9977835265164837, 0.7845252382965495, 0.7496585913499988, 0.5511919236029462, 1.56436534037, 1.573121897099459, 0.9698428059533438, 2.3360059051774047, 0.6443709039144875, 0.8874319451664675, 0.6677077718979024, 0.753477505390455, 1.659544963544636, 0.7710165580234796, 1.2002469401323212, 0.7818366967495781, 0.8882177799060202, 0.7249081766570725, 0.8213780945390134, 1.6045903654090579, 1.0262290156017941, 0.8362376222233388, 0.7000165773222967, 1.0717094626168986, 0.5972737159171536, 0.9173833263682487, 1.141800709191788, 3.3246844186505498, 1.2304639298429125, 1.1727550451243671, 0.6431052205782503, 0.33215054979615044, 0.9418468817380687, 1.806324253054093, 0.9576096063122668, 0.9851566508384538, 0.7818366967495781, 0.853837894509849, 0.5880009732956087, 1.2471945009316892, 1.7414978012505438, 0.9277581957451251, 0.9291529135814874, 0.7818366967495781, 0.8664885016902584, 0.9821834439526526, 1.019314807075832, 1.5534499122425118, 0.9543020731325699, 0.8692470020479443, 0.7818366967495781, 0.8203231306985643, 0.5361320349799149, 1.1837419825123268, 1.533275238057544, 0.9986500180113639, 1.2078987876559335, 0.8578485978224538, 0.7502698384755472, 0.524811679511589, 1.5697448028967813, 1.5391779856324446, 1.003710744453989, 0.7232325381391037, 0.9086210259522124, 0.9019414378625167, 0.6020009964693137, 0.8999870203274879, 1.533275238057544, 1.033813751039933, 0.9893515530529642, 0.781836696749578, 0.8407957366290202, 0.5613812109230711, 1.4682075185025325, 1.554279008441894, 0.9097291259966535, 0.8362376222233388, 1.9659937055364056, 0.8418120086716822, 0.6440010659904286, 0.9866967332494053, 1.91659404757193, 1.1234812702627843, 0.8495112352745028, 0.7694265904519658, 0.8778896661861828, 0.6164454648231363, 0.9966633669185911, 4.036502492087329, 0.9576096063122668, 0.8362376222233388, 0.835387155431056, 0.864979524036386, 0.5338814807286, 1.1948803723542663, 1.5561599431031792, 0.9292993223161303, 0.9424265266326515, 0.7818366967495782, 0.7524768567310138, 0.8760014500118254, 1.1837419825123268, 2.2622093676258848, 1.20329141514484, 0.8362376222233386, 0.884372656979031, 0.7524768567310138, 0.6387510573002892, 1.3174643881455128, 1.533275238057544, 1.1195802936299275, 0.979965963542975, 0.7581446756359546, 0.7725429062438409, 0.6103621214202763, 1.9891095396744478, 1.6099389999604212, 0.786436889183949, 0.8362376222233388, 1.8083958807718814, 0.7437676338521827, 0.5460009037744938, 1.1611810870743313, 1.777710420936283, 0.9244749260938532, 1.0907447246391375, 0.7389963298043957, 0.7095272644518464, 0.535334219451671, 2.1911936891569264, 1.4804036781245253, 1.0043893859309694, 0.9035211090688947, 0.7909278211303872, 0.8677989803679508, 0.7130244360561369, 0.9856537134468161, 1.7497376246068443, 0.9634412032737837, 0.911284588320305, 0.7818366967495781, 0.6086701685557534, 0.9129881779012134, 0.946463778217177, 1.691112394916409, 0.9204224332671405, 0.7581887774824938, 0.8339591431995499, 0.8778896661861828, 0.7364423954756276, 0.8790570896221975, 4.828666021269229, 0.7703402277094239, 0.8362376222233388, 2.6773617049165885, 0.9587479249138575, 0.6723695340003045, 0.7848724014483907, 1.7708249228270228, 0.8738187657599435, 0.9346185189554962, 0.781836696749578, 0.6713273917894339, 0.5206423712334434, 2.1833139157876933, 1.5627613003278815, 0.9648415538599376, 0.8362376222233386, 0.6841071096558808, 0.8778896661861829, 0.715401184176324, 1.255795842317425, 2.299912857086316, 0.9986500180113639, 0.8362376222233388, 0.5105872305303367, 1.0928830538236154, 0.8968586273930592, 1.197262985260257, 1.8349031537409952, 0.8592551196639443, 0.9059240907419503, 0.9903264825494656, 0.8778896661861829, 0.6706886101653038, 0.797330693534873, 1.5576129402489336, 0.8738187657599434, 0.823171409376099, 1.0628092596439578, 1.028776952561933, 0.6132010150082777, 0.9156844683564558, 1.7172682666244494, 1.2015008029199221, 1.8690294132268472, 0.7818366967495781, 0.8535038421254556, 0.6387510573002892, 1.1555065910212416, 1.592247362598219, 0.8738187657599434, 0.9950169175822005, 0.7719400297021151, 0.9566746362285325, 0.5574554681893433, 0.8843632692376232, 1.5777179985809513, 1.1030171305494367, 0.9459081300559077, 0.7690197017208965, 0.8778896661861829, 0.7539356741905054, 0.9264067689226906, 2.4833779731661942, 0.9401847479695593, 0.889164054009626, 0.7818366967495781, 0.6111890081043044, 0.657001087508869, 1.177308602172586, 2.8748910713578955, 0.7196154541552476, 1.0084041915046142, 0.7818366967495781, 1.0457215141335412, 0.4542229740802057, 1.0077374043287979, 1.5689328017333009, 0.995746965633424, 0.8647457229809525, 0.7640676809143605, 0.7758094724436034, 1.551304129839939, 0.7749373077591706, 1.5937992606124471, 0.8623211504209969, 0.9254363019271615, 0.7818366967495781, 0.8544792750878846, 0.47065867380021315, 2.3671152646113933, 1.1549345949004879, 0.8738187657599434, 0.8905387665235555, 1.0340420827978292, 0.8373716815929744, 0.6446472209061381, 1.1591961621391615, 1.533275238057544, 0.9845845247999362, 0.9069055902985504, 0.9580252481297646, 0.8094826792106361, 0.5043644712189297, 0.6954565582454094, 1.533275238057544, 0.9623067420394313, 0.9420904857959131, 0.8610100331292821, 0.7047846615860904, 0.6045643809940766, 0.8843632692376232, 1.533275238057544, 1.0091991379199345, 2.0483752734578298, 0.7818366967495781, 0.6958881500256328, 1.4738562612397381, 1.2515532887960823, 1.533275238057544, 0.8738187657599434, 0.9492427063075736, 0.8346635005840091, 0.8541629184514211, 0.6209630531729394, 1.4647549055284526, 1.6847759031922702, 1.0839777094237273, 0.8362376222233386, 0.702663360369874, 0.8778896661861828, 0.6080263228985032, 0.9935093689220135, 1.5524411785332632, 0.9493339677391978, 0.9910964411535865, 0.7721843918514352, 0.9421254954193182, 0.39882992846066845, 0.9026032616656492, 1.5716071190089826, 1.2790680484312213, 0.9695508663459, 0.781836696749578, 0.0, 0.5924647488002683, 1.0919963846238478, 3.7296650578894712, 0.8738187657599434, 0.7317079194454214, 0.8570133022062683, 0.965678632804801, 0.6745211165091055, 0.926149433709101, 1.5971617063099417, 0.9102278809999411, 0.8108970882165708, 0.7265553141511231, 0.9053237182545011, 1.248278189143995, 0.9830725028242467, 1.0221834920383626, 1.019455226719934, 0.9621228556763144, 0.7818366967495781, 0.9044923833433398, 0.47486947290203324, 0.7769443973933563, 1.4881789075264398, 1.0223679559391339, 0.9198613844456726, 0.8365652655220486, 0.8204576319497036, 0.4249908024809846, 0.6527651655610377, 1.6243608957639328, 0.8652519151152381, 0.8936264786504307, 0.7818366967495781, 1.086497111616563, 0.6111970901226298, 0.8415126778415735, 1.533275238057544, 0.9830461114799365, 0.8362376222233386, 0.806017213143895, 0.8778896661861828, 0.4897091439302218, 1.6598743169964383, 1.2777293650479533, 0.8263712813554513, 0.947349343483371, 0.9854400031947806, 0.9016164139209445, 0.4051177876931565, 0.6080993380591135, 1.719126782064519, 0.8644228650528473, 2.3129541352087273, 0.8322777739592283, 0.8874319451664675, 0.46154915108149935, 0.810190866011242, 1.5003015770240484, 1.2195053104561848, 0.8821847443235222, 0.9086556868971348, 0.7407194058445917, 0.3938964853351784, 1.3506591210885943, 1.533275238057544, 0.9820794978009985, 2.7835878732612978, 0.8787014202406763, 0.8778896661861828, 0.4887834177602214, 0.6278979211587126, 1.4310568888537079, 0.9135378005672136, 0.8552430227284146, 0.9772958709369727, 0.8583810069376009, 0.4996452714882263, 0.7426749605103051, 1.533275238057544, 0.9395900707096166, 0.8632130293918335, 0.849091466362445, 0.7498640898673645, 0.5429383987052459, 0.80401563075201, 2.000737200879966, 2.1054569840535127, 0.6413861374334345, 0.8881057623271906, 0.8778896661861829, 0.45642793997379894, 0.5486486689736323, 1.5788180669107383, 1.0810129060947753, 0.8707216478820331, 0.7818366967495781, 0.7577573960764946, 0.4625902393922095, 0.7766105866963023, 1.533275238057544, 1.26013864114855, 3.141462186401785, 0.8723651563732134, 0.6956861505626355, 0.5013593204470195, 0.8008902055595822, 1.6755378890113368, 1.176980378370536, 0.8362376222233388, 0.7738587712725415, 0.9764283021866728, 0.6674296761994859, 0.6705705954122172, 1.4759565375694117, 0.9586555391346953, 0.9011881171533067, 0.8121992869146102, 0.7794347503522184, 0.47757088396283315, 0.7775371453600879, 1.533275238057544, 2.5600381131277548, 0.9171638437288231, 0.9079393897737036, 0.6261418942651451, 0.4568037864329341, 0.7912534778829303, 3.739235538469332, 1.1198454085467238, 0.9986138595482588, 0.781836696749578, 0.740181483255017, 0.4609027236990323, 0.7387034366573089, 1.533275238057544, 1.0391358295523652, 0.8437712944956209, 0.8804467305738491, 0.8700513655952348, 0.4653757703187822, 0.7984046842319835, 1.5332752380575443, 0.888884606548908, 1.0525059727983401, 0.8559763835103139, 0.8778896661861828, 0.5677787176002571, 0.6342403244027399, 1.3783989513850647, 0.9720006495531954, 2.5597656433031677, 0.9223916085247832, 0.6562003565432073, 0.37960062833845765, 0.5078586127018998, 1.6986284500049262, 0.9487175171107958, 0.8123451187312433, 0.8637433983138196, 0.8778896661861828, 0.5840009666745503, 0.9472597948515059, 1.533275238057544, 2.2955769702626587, 0.8854280705894175, 0.9066677659785023, 0.8012485048524685, 0.6813344611203086, 0.9008970173146745, 1.7599333167269202, 1.07770981110393, 0.7944257411121718, 0.7818366967495781, 0.8925211606226193, 0.5024841650762276, 0.8363394441663179, 1.533275238057544, 0.8738187657599434, 0.9494126387648432, 0.8288644679826355, 0.9837345195561482, 0.46023917241239387, 0.6557161834885289, 1.6386879106740002, 0.9065869694759413, 0.8937289587511933, 0.7818366967495781, 0.8778896661861828, 0.47397179904021464);
		
		Serie serie = new Serie(webTraffic, 7)
						.multiplicative()
						.smoothWithMedian();
		
		assertThat(serie.trend(), closeTo(expectedMM, 0.0001));
		assertThat(serie.detrend(), closeTo(expectedDetrend, 0.0001));
		assertThat(serie.season(), closeTo(expectedSeason, 0.01));
		assertThat(serie.residual(), closeTo(expectedResidual, 0.01));

	}
	
	@Test 
	public void multiplicativeDecompositionWithMovingAverage() {
		List<Double> webTraffic = asList(32.0000,27.0000,30.0000,25.0000,14.0000,41.0000,32.0000,48.0000,22.0000,26.0000,23.0000,27.0000,40.0000,42.0000,46.0000,49.0000,26.0000,15.0000,20.0000,33.0000,32.0000,46.0000,32.0000,38.0000,27.0000,31.0000,65.0000,33.0000,42.0000,98.9258,37.0000,20.0000,23.0000,37.0000,30.0000,16.0000,33.0000,28.0000,37.0000,18.0000,38.0000,32.0000,16.0000,31.0000,34.0000,25.0000,27.0000,47.0000,48.0000,43.0000,44.0000,46.0000,25.0000,31.0000,40.0000,45.0000,46.0000,48.0000,33.0000,29.0000,26.0000,43.0000,71.0000,43.0000,51.0000,34.0000,47.5913,30.0000,47.0000,49.0000,49.0000,48.0000,83.6512,36.0000,33.0000,45.0000,53.0000,48.0000,30.0000,68.8295,20.0000,18.0000,76.1802,47.0000,35.0000,52.0000,50.0000,27.0000,27.0000,55.0000,58.0000,51.0000,51.0000,52.0000,37.0000,36.0000,44.0000,51.0000,122.5844,48.0000,54.0000,35.0000,37.0000,60.0000,54.0000,57.0000,40.0000,35.0000,22.0000,34.0000,50.0000,64.0000,45.0000,50.0000,59.0000,29.0000,23.0000,60.0000,56.0000,58.0000,53.0000,163.7260,37.0000,28.0000,61.0000,74.0000,36.0000,51.0000,52.0000,30.0000,31.0000,59.0000,73.0000,64.0000,82.0000,63.0000,37.0000,53.0000,89.0000,89.0000,84.0000,96.0000,71.0000,55.0000,63.0000,106.0000,76.0000,102.0000,113.0000,59.0000,49.0000,50.0000,71.0000,96.0000,99.0000,100.0000,71.0000,58.0000,46.0000,83.0000,66.0000,200.8601,61.0000,67.0000,58.0000,46.0000,83.0000,76.0000,200.8601,67.0000,74.0000,49.0000,48.0000,74.0000,89.0000,86.0000,149.7946,78.0000,49.0000,61.0000,81.0000,98.0000,230.2393,76.0000,65.0000,46.0000,37.0000,89.0000,105.0000,87.0000,77.0000,61.0000,101.5120,48.0000,81.0000,75.0000,91.0000,91.0000,77.0000,48.0000,29.0000,85.0000,102.0000,95.0000,94.0000,78.0000,46.0000,58.0000,88.0000,107.0000,114.0000,71.0000,82.0000,49.0000,45.0000,92.0000,99.0000,79.0000,180.7076,86.0000,49.0000,44.0000,77.0000,94.0000,100.0000,91.0000,70.0000,51.0000,37.0000,88.0000,90.0000,105.0000,89.0000,76.0000,48.0000,88.6950,91.0000,101.0000,254.2059,75.0000,93.0000,49.0000,36.0000,92.0000,75.0000,122.0000,85.0000,86.0000,61.0000,45.0000,90.0000,101.0000,86.0000,77.0000,94.0000,45.0000,45.0000,70.0000,266.3343,103.0000,105.0000,63.0000,26.0000,48.0000,86.0000,80.0000,86.0000,73.0000,71.0000,42.0000,58.0000,92.0000,86.0000,90.0000,81.0000,76.0000,74.0000,50.0000,77.0000,83.0000,79.0000,76.0000,57.0000,32.0000,46.0000,61.0000,72.0000,91.0000,79.0000,63.0000,38.0000,73.7162,74.0000,85.0000,64.0000,86.0000,75.0000,43.0000,43.0000,73.0000,84.0000,84.0000,71.0000,68.0000,39.0000,66.4074,74.0000,76.0000,73.0000,183.5646,70.0000,46.0000,44.0000,80.0000,81.0000,64.0000,62.0000,63.0000,38.0000,40.0000,192.1799,80.0000,73.0000,78.0000,67.0000,35.0000,51.0000,68.0000,67.0000,71.0000,63.0000,54.0000,54.0000,46.0000,90.0000,84.0000,61.0000,69.0000,48.0000,35.0000,47.0000,56.0000,82.0000,75.0000,64.0000,66.0000,43.0000,91.2351,84.0000,72.0000,80.0000,166.5367,61.0000,39.0000,54.0000,80.0000,73.0000,90.0000,69.0000,59.0000,44.0000,117.2549,84.0000,100.0000,94.0000,87.0000,86.0000,60.0000,54.0000,97.0000,86.0000,85.0000,78.0000,52.0000,67.0000,41.0000,75.0000,79.0000,68.0000,80.0000,75.0000,49.0000,42.0000,236.1937,67.0000,76.0000,260.2583,83.0000,50.0000,38.0000,82.0000,68.0000,76.0000,71.0000,52.0000,27.0000,73.7162,53.0000,53.0000,48.0000,35.0000,40.0000,28.0000,32.0000,60.0000,56.0000,49.0000,32.0000,61.0000,43.0000,45.0000,73.0000,59.0000,65.0000,76.0000,60.0000,42.0000,32.0000,64.0000,64.0000,63.0000,87.0000,75.0000,45.0000,49.0000,84.0000,99.0000,160.9233,72.0000,70.0000,45.0000,53.0000,81.0000,79.0000,94.0000,78.0000,85.0000,42.0000,40.0000,71.0000,77.0000,69.0000,60.0000,61.0000,45.0000,36.0000,127.9528,85.0000,84.0000,79.0000,55.0000,36.0000,42.0000,105.0000,56.0000,82.0000,68.0000,81.0000,36.0000,52.0000,88.0000,98.0000,91.0000,86.0000,76.0000,119.9147,39.0000,79.0000,75.0000,83.0000,76.0000,73.0000,35.0000,114.6051,58.0000,77.0000,82.0000,82.0000,62.0000,41.0000,48.0000,65.0000,80.0000,77.0000,87.0000,71.0000,38.0000,35.0000,79.0000,87.0000,89.0000,87.0000,57.0000,42.0000,40.0000,71.0000,82.0000,200.8601,82.0000,65.0000,106.7174,59.0000,74.0000,74.0000,84.0000,79.0000,72.0000,48.0000,73.7162,81.0000,98.0000,79.0000,71.0000,79.0000,47.0000,50.0000,81.0000,88.0000,96.0000,80.0000,88.0000,32.0000,46.0000,82.0000,101.0000,80.0000,69.0000,0.0000,40.0000,48.0000,221.3559,104.0000,91.0000,114.0000,110.0000,66.0000,59.0000,100.0000,100.0000,96.0000,92.0000,99.0000,117.2549,62.0000,66.0000,119.0000,107.0000,93.0000,102.0000,46.0000,49.0000,99.0000,117.0000,110.0000,107.0000,100.0000,42.0000,42.0000,107.0000,101.0000,109.0000,102.0000,125.0000,61.0000,52.0000,97.0000,108.0000,96.0000,100.0000,96.0000,46.0000,101.5120,80.0000,96.0000,115.0000,121.0000,114.0000,44.0000,43.0000,111.0000,92.0000,257.2292,99.0000,93.0000,42.0000,48.0000,91.0000,127.0000,96.0000,109.0000,81.0000,37.0000,93.7871,113.0000,127.0000,376.1436,127.0000,97.0000,44.0000,36.0000,84.0000,92.0000,90.0000,110.0000,88.0000,44.0000,44.0000,93.0000,100.0000,96.0000,101.0000,82.0000,51.0000,42.0000,107.0000,248.1774,79.0000,117.0000,103.0000,46.0000,36.0000,104.0000,120.0000,101.0000,97.0000,82.0000,43.0000,47.0000,95.0000,137.0000,356.8829,106.0000,84.0000,52.0000,50.0000,106.0000,132.0000,98.0000,97.0000,109.0000,64.0000,44.0000,103.0000,113.0000,111.0000,107.0000,95.0000,50.0000,53.0000,124.0000,363.2844,136.0000,144.0000,97.0000,59.0000,62.0000,251.1886,132.0000,123.0000,103.0000,86.0000,46.0000,48.0000,102.0000,132.0000,112.0000,125.0000,111.0000,51.0000,59.0000,116.0000,118.0000,146.0000,127.0000,109.0000,55.0000,40.0000,89.0000,99.0000,272.4335,105.0000,74.0000,39.0000,33.0000,113.0000,114.0000,102.0000,116.0000,105.0000,60.0000,70.0000,119.0000,312.6205,126.0000,138.0000,115.0000,84.0000,66.0000,132.0000,148.0000,114.0000,120.0000,122.0000,59.0000,65.0000,129.0000,133.0000,151.0000,141.0000,158.0000,68.0000,66.0000,171.0000,166.0000,171.0000,160.0000,138.0000,64.0000,40.0000,107.0000,138.0000);
		
		List<Double> expectedMA = asList(28.7143,31.0000,30.2857,29.7143,29.4286,31.2857,31.1429,32.5714,32.2857,36.1429,36.1429,35.0000,34.0000,33.0000,31.5714,31.5714,29.1429,30.8571,32.5714,34.1429,38.7143,38.8571,38.2857,47.8465,47.7037,46.7037,45.5608,41.5608,41.1323,37.4180,28.0000,26.7143,29.1429,28.4286,28.5714,28.8571,28.8571,28.5714,29.4286,27.7143,29.0000,30.2857,32.5714,36.4286,38.2857,40.0000,40.0000,40.5714,39.5714,39.1429,39.5714,40.1429,38.2857,38.8571,38.1429,38.5714,42.2857,41.8571,42.2857,42.4286,45.0845,45.6559,46.2273,43.0845,43.9416,43.5130,50.6061,48.9502,49.3787,49.0930,49.6645,49.5216,46.9502,44.8328,42.5471,40.4042,44.8585,44.0014,42.1442,45.2871,42.5972,43.5972,44.8829,41.8571,43.4286,45.7143,45.5714,45.8571,47.2857,48.5714,47.0000,46.0000,56.2263,55.7978,56.0835,55.7978,55.9406,58.2263,58.6549,49.2857,48.1429,45.4286,43.5714,43.1429,41.7143,43.1429,41.4286,42.8571,46.2857,47.2857,45.7143,47.1429,46.0000,47.8571,48.2857,63.2466,64.3894,65.1037,65.2466,67.8180,64.6751,64.3894,48.4286,47.4286,47.8571,47.5714,47.4286,51.4286,55.8571,57.4286,58.4286,61.5714,65.8571,68.1429,71.0000,73.0000,74.1429,76.7143,78.1429,80.5714,78.7143,81.2857,83.7143,82.0000,81.1429,79.2857,74.2857,77.1429,76.7143,74.8571,76.5714,77.8571,77.2857,79.0000,74.7143,89.2657,83.6943,83.1229,83.1229,83.1229,83.1229,84.5514,84.5514,85.4086,86.4086,85.1229,85.4086,84.1229,85.9800,69.5714,81.3992,81.9707,81.9707,83.8278,84.8278,86.1135,106.7191,96.1770,94.3199,93.8913,90.4628,91.6056,92.6056,72.1429,72.2857,71.7143,79.6446,81.2160,80.0731,75.7874,76.3589,78.3589,80.6446,73.0000,70.2857,70.8571,74.7143,75.2857,75.7143,75.8571,75.5714,79.7143,80.1429,80.8571,83.5714,80.2857,80.8571,81.2857,79.4286,80.0000,78.8571,73.8571,89.5297,90.1011,90.1011,89.9582,87.8154,87.1011,90.1011,77.2857,75.0000,75.2857,74.2857,75.8571,75.2857,76.0000,75.7143,76.5714,76.1429,83.5279,83.9564,85.5279,106.8430,104.8430,107.2716,107.4144,99.8866,100.0294,96.3151,77.4286,78.8571,77.8571,79.5714,80.8571,80.5714,84.2857,79.1429,78.0000,79.1429,76.8571,76.8571,74.0000,97.6192,100.0478,104.0478,99.6192,96.9049,97.3335,99.6192,73.0000,70.5714,66.0000,67.1429,69.4286,70.8571,71.7143,72.5714,73.1429,74.2857,75.0000,79.5714,78.4286,76.2857,75.8571,74.2857,73.5714,70.8571,64.8571,64.2857,62.0000,60.4286,62.1429,62.5714,63.4286,64.2857,68.2452,70.1023,71.9595,68.1023,69.1023,70.8166,71.5309,67.1429,67.0000,66.8571,69.7143,67.5714,66.5714,66.0000,69.3439,69.4868,68.3439,66.7725,82.8531,83.1389,84.1389,80.9378,81.7949,82.5092,81.2235,63.8571,62.8571,61.7143,61.1429,77.1686,77.0257,78.3114,80.5971,81.1686,80.7400,82.3114,64.5714,62.7143,62.4286,60.2857,58.4286,61.1429,60.4286,63.5714,66.0000,64.5714,65.4286,64.5714,61.8571,62.0000,57.1429,56.8571,58.8571,58.1429,60.7143,61.8571,68.1764,72.1764,70.7479,71.4622,86.1103,85.3960,84.8246,79.5052,78.9338,79.0767,80.5052,66.5714,66.2857,67.0000,76.0364,76.6078,80.4650,81.0364,83.6078,87.4650,89.7507,80.7143,82.5714,80.5714,79.2857,78.0000,73.1429,74.1429,72.2857,69.1429,68.1429,65.7143,66.0000,69.2857,66.7143,66.8571,89.8848,88.1705,89.3134,115.0646,116.2074,116.3503,115.7789,93.7512,93.8940,93.8940,66.8571,62.4286,59.1429,64.2452,60.1023,57.9595,53.9595,48.8166,47.1023,47.2452,41.2857,42.2857,42.7143,42.8571,42.4286,45.4286,47.5714,49.4286,51.2857,51.7143,54.0000,60.2857,60.1429,60.0000,58.1429,56.8571,57.5714,57.2857,58.8571,61.0000,61.4286,63.8571,66.7143,71.7143,85.7033,83.5605,82.8462,82.8462,83.4176,82.9890,80.1319,70.5714,71.4286,73.5714,73.1429,71.2857,69.8571,69.5714,66.0000,63.4286,60.0000,60.4286,59.8571,67.9933,69.1361,71.2790,73.9933,73.1361,71.8504,72.7075,69.4286,65.2857,65.0000,63.4286,67.1429,67.1429,68.5714,66.1429,72.1429,73.4286,76.0000,75.2857,87.2735,85.4164,84.1307,80.8450,79.7021,78.2735,77.8450,65.7143,76.5150,73.5150,73.8007,73.6579,74.5150,72.9436,73.8007,64.2857,65.2857,65.7143,65.0000,65.7143,67.0000,66.5714,64.7143,66.7143,67.7143,69.4286,69.4286,67.4286,68.0000,68.7143,67.5714,66.8571,82.8372,82.1229,83.2657,92.5111,95.2254,95.6539,94.5111,77.8168,77.3882,78.3882,70.0000,72.1023,73.1023,76.5309,75.8166,74.6737,75.6737,75.5309,72.1429,72.1429,70.7143,73.1429,74.4286,75.7143,73.5714,73.0000,73.1429,75.0000,72.7143,71.1429,58.5714,59.7143,60.0000,79.9080,80.3366,81.9080,88.3366,104.0508,107.7651,109.3366,92.0000,91.4286,92.1429,89.0000,87.4286,94.7507,95.1793,90.3221,93.0364,94.6078,94.7507,95.1793,85.0000,83.1429,87.8571,87.5714,88.0000,90.0000,89.7143,89.1429,88.1429,89.2857,87.0000,86.8571,86.1429,89.7143,92.4286,93.8571,92.4286,93.4286,91.5714,91.2857,87.1429,85.0000,92.0731,89.6446,87.9303,90.6446,93.6446,96.2160,95.9303,87.5714,92.0000,91.4286,111.7470,108.6042,105.6042,105.3185,106.0327,103.1756,108.1756,85.1429,86.5714,84.8571,84.1429,90.6839,93.8267,93.8267,133.8472,136.4187,138.7044,139.7044,131.4491,127.3062,122.3062,81.4286,79.0000,77.7143,77.7143,78.8571,80.1429,81.2857,82.1429,80.8571,80.0000,81.0000,80.7143,82.7143,103.8825,101.4539,103.7396,106.7396,106.0253,105.1682,104.7396,86.4286,89.5714,86.7143,83.7143,83.2857,84.8571,83.5714,86.0000,122.5547,123.8404,124.1261,125.4118,125.8404,127.4118,126.6976,89.7143,88.4286,92.0000,93.7143,92.8571,92.4286,89.7143,91.5714,93.0000,91.0000,89.0000,90.2857,93.2857,129.0406,132.6121,137.8978,138.1835,139.4692,140.7549,158.9247,125.8841,124.0269,118.1698,116.5984,114.7412,112.7412,91.4286,91.4286,89.8571,93.0000,96.5714,97.2857,98.8571,100.8571,98.8571,103.7143,104.0000,103.7143,104.2857,101.5714,97.7143,95.0000,113.0619,109.9191,104.9191,102.6334,101.6334,105.0619,107.2048,82.8571,84.4286,88.8571,91.8571,97.1429,98.0000,126.3744,129.8029,132.9458,134.3744,137.8029,137.2315,139.0886,115.5714,113.8571,111.2857,112.2857,108.7143,108.5714,108.1429,106.0000,111.2857,114.2857,119.4286,120.7143,120.8571,126.8571,131.5714,134.4286,137.1429,134.2857,133.7143,130.0000,120.8571,116.8571);
//		List<Double> expectedDetrend = asList(0.8333333,0.4666667,1.3666667,1.2307692,1.8461538,0.8148148,0.9629630,0.8518519,1.0000000,1.0000000,1.0500000,1.1500000,1.2250000,0.7878788,0.4687500,0.6250000,1.0312500,1.0000000,1.4375000,1.0000000,1.1875000,0.8181818,0.9393939,1.7105263,0.8918919,1.1351351,2.6736692,1.0000000,0.5405405,0.7666667,1.2333333,1.0714286,0.5333333,1.1000000,0.9333333,1.1562500,0.5625000,1.2258065,1.0000000,0.5161290,1.0000000,1.0967742,0.8064516,0.7941176,1.0930233,1.0909091,0.9772727,1.0000000,1.0697674,0.5813953,0.7045455,0.8888889,1.1250000,1.1500000,1.2000000,0.7674419,0.6744186,0.6046512,1.0000000,1.6511628,1.0000000,1.1860465,0.7234043,1.0125819,0.6303667,0.9875745,1.0208333,1.0208333,1.0000000,1.7427326,0.7500000,0.6875000,1.0000000,1.1777778,1.0666667,0.6666667,1.4339482,0.4255319,0.5142857,1.6208552,1.0000000,0.7446809,1.1063830,1.0638298,0.5400000,0.5294118,1.0784314,1.1372549,1.0000000,1.0000000,1.0196078,0.7254902,0.7058824,0.9166667,1.0625000,2.5538418,1.0000000,1.0588235,0.6481481,0.6851852,1.1111111,1.3500000,1.4250000,1.0000000,0.8750000,0.5500000,0.8500000,1.1111111,1.2800000,0.9000000,1.0000000,1.1800000,0.5800000,0.4107143,1.0714286,1.0000000,1.0357143,0.9464286,2.9236785,0.6379310,0.5283019,1.1960784,1.4509804,0.7058824,1.0000000,1.0196078,0.5882353,0.5961538,1.0000000,1.1587302,1.0158730,1.3015873,0.9843750,0.5781250,0.6463415,1.0595238,1.0595238,1.0000000,1.1428571,0.8452381,0.7236842,0.8289474,1.3947368,1.0000000,1.3421053,1.4868421,0.8309859,0.6901408,0.7042254,1.0000000,1.3521127,1.3943662,1.4084507,0.8554217,0.8169014,0.6478873,1.2575758,1.0000000,3.0433351,0.9242424,1.0151515,0.8656716,0.6865672,1.2388060,1.0270270,2.7143259,0.9054054,1.0000000,0.6621622,0.6486486,1.0000000,1.1410256,1.1025641,1.9204430,0.9629630,0.6049383,0.7530864,1.0384615,1.2894737,3.0294650,1.0000000,0.8552632,0.6052632,0.4868421,1.1558442,1.3636364,1.0000000,0.8850575,0.7530864,1.3183378,0.6233766,1.0000000,0.9259259,1.1818182,1.1818182,1.0000000,0.5647059,0.3411765,1.0000000,1.2000000,1.1176471,1.1058824,0.8863636,0.5227273,0.6590909,1.1282051,1.3048780,1.3902439,0.8658537,1.0000000,0.5975610,0.5696203,1.1219512,1.1511628,0.9186047,2.1012506,1.0886076,0.6202532,0.5116279,0.8953488,1.2207792,1.2987013,1.1818182,0.7954545,0.5795455,0.4204545,1.0000000,1.0227273,1.1931818,1.0034387,0.8539326,0.5393258,0.9965731,1.0259879,1.1098901,2.7934716,0.8241758,1.0108696,0.6533333,0.4800000,1.0823529,0.8823529,1.4352941,1.0000000,1.0117647,0.7093023,0.5232558,1.0465116,1.1744186,1.0000000,0.8953488,1.2207792,0.5844156,0.5844156,0.7446809,3.8047762,1.4714286,1.5000000,0.7325581,0.3250000,0.6000000,1.1780822,1.0958904,1.1780822,1.0000000,0.9726027,0.5753425,0.7945205,1.1358025,1.0617284,1.1111111,1.0000000,0.9870130,0.9610390,0.6493506,1.0131579,1.0921053,1.0394737,1.0000000,0.9344262,0.5245902,0.7540984,1.0000000,1.1428571,1.4444444,1.0972222,0.8546288,0.5135135,1.0000000,1.0038498,1.1486486,0.8648649,1.1621622,1.0273973,0.5890411,0.5733333,1.0000000,1.1830986,1.1830986,1.0000000,0.9577465,0.5492958,0.9353160,1.0136986,1.0410959,1.0000000,2.5145832,0.9589041,0.6301370,0.6285714,1.2500000,1.2857143,1.0158730,0.9841270,1.0000000,0.6031746,0.6349206,2.6326015,1.0958904,1.0000000,1.0684932,0.9852941,0.5223881,0.7611940,1.0149254,1.0634921,1.1269841,1.0000000,0.8571429,0.8571429,0.7540984,1.4754098,1.3770492,1.0000000,1.1311475,0.8571429,0.6250000,0.8392857,1.0000000,1.2812500,1.1718750,0.9696970,0.8800000,0.5972222,1.2671547,1.0500000,0.9000000,1.0000000,2.3130101,0.8472222,0.5342466,0.7397260,1.1594203,1.0579710,1.3043478,0.9452055,0.8082192,0.5238095,1.3958918,0.9655172,1.1494253,1.0804598,1.0116279,0.9885057,0.6976744,0.6279070,1.1411765,1.1025641,1.0897436,1.0000000,0.6933333,0.8933333,0.6029412,1.1029412,1.0533333,0.9066667,1.0666667,1.0000000,0.7205882,0.5600000,3.1492495,0.8815789,1.0000000,3.4244520,1.0921053,0.6578947,0.5000000,1.1549296,1.0000000,1.1176471,1.0000000,0.7647059,0.5094340,1.3908719,1.0192308,1.1041667,1.0000000,0.8750000,1.0000000,0.7000000,0.8000000,1.5000000,1.1428571,1.0000000,0.6530612,1.2448980,0.8775510,0.7627119,1.1967213,0.9833333,1.0833333,1.2666667,1.0000000,0.6562500,0.5079365,1.0158730,1.0000000,0.9843750,1.3593750,1.1718750,0.6000000,0.5833333,1.1200000,1.3750000,2.2350457,1.0000000,0.9722222,0.6250000,0.7361111,1.0384615,1.0000000,1.1898734,0.9873418,1.0897436,0.5454545,0.5633803,1.0289855,1.2622951,1.1311475,0.9836066,1.0000000,0.7377049,0.5901639,1.6196558,1.0759494,1.0632911,1.0000000,0.6962025,0.6428571,0.7500000,1.8750000,0.8235294,1.2058824,1.0000000,1.1911765,0.4444444,0.6419753,1.0232558,1.1395349,1.0340909,0.9772727,0.8837209,1.5179079,0.4936709,1.0394737,0.9868421,1.1066667,1.0000000,0.9733333,0.4605263,1.5079621,0.7532468,1.0000000,1.0649351,1.3225806,0.9538462,0.6307692,0.7384615,1.0000000,1.1267606,1.0845070,1.2253521,0.9220779,0.4935065,0.4430380,1.0000000,1.1012658,1.1265823,1.1012658,0.8028169,0.5915493,0.5633803,1.0000000,1.1549296,2.4495136,1.0000000,0.7926829,1.4421272,0.7972973,1.0000000,1.0000000,1.1351351,1.0675676,0.9729730,0.6075949,0.9331166,1.0988085,1.2405063,1.0000000,0.8987342,1.0000000,0.5949367,0.6329114,1.0125000,1.0864198,1.1851852,0.9876543,1.0731707,0.3902439,0.5750000,1.0250000,1.4637681,1.1594203,1.0000000,0.0000000,0.5797101,0.6956522,2.4324819,1.0000000,0.8750000,1.0961538,1.1000000,0.6600000,0.5900000,1.0416667,1.0416667,0.9696970,0.9292929,1.0312500,1.2214053,0.6262626,0.6666667,1.1666667,1.1505376,1.0000000,1.0303030,0.4646465,0.4949495,0.9705882,1.1700000,1.1000000,1.0700000,0.9345794,0.4158416,0.4158416,1.0594059,0.9901961,1.0686275,1.0000000,1.2376238,0.5980392,0.5360825,1.0000000,1.1250000,1.0000000,1.0309278,1.0000000,0.4791667,1.0574168,0.8333333,0.9457009,1.1328709,1.2604167,1.0270270,0.3963964,0.3873874,1.1212121,0.9892473,2.7659050,1.0645161,1.0108696,0.4516129,0.5161290,0.9784946,1.3956044,1.0549451,1.1622065,0.8437500,0.3854167,0.8604323,1.0000000,1.1238938,3.3287042,1.1238938,1.0000000,0.4782609,0.4000000,0.9333333,1.0454545,1.0227273,1.2500000,0.9777778,0.4888889,0.4731183,1.0000000,1.0752688,1.0322581,1.0860215,0.8541667,0.5312500,0.5121951,1.3048780,2.4094893,0.7669903,1.1359223,1.0000000,0.4466019,0.3495146,1.0297030,1.2371134,1.0412371,1.0000000,0.8631579,0.4526316,0.4947368,1.0000000,1.4421053,3.7566623,1.1157895,0.7924528,0.4905660,0.5102041,1.0927835,1.3469388,1.0000000,0.9897959,1.1122449,0.6530612,0.4271845,0.9626168,1.0970874,1.0776699,1.0388350,0.8878505,0.4672897,0.4953271,1.0000000,2.9297125,1.0967742,1.1612903,0.7132353,0.4469697,0.5040650,2.4387247,1.2815534,1.1941748,1.0000000,0.8431373,0.4509804,0.4705882,1.0000000,1.1891892,1.0090090,1.1261261,0.9910714,0.4553571,0.5086207,1.0000000,1.0172414,1.2586207,1.0948276,1.0000000,0.5555556,0.4040404,0.8989899,1.1123596,3.0610507,1.1797753,0.7474747,0.3714286,0.3235294,1.1078431,1.0857143,0.9714286,1.1047619,1.0000000,0.5714286,0.6034483,1.0000000,2.6270633,1.0588235,1.1596639,0.9126984,0.6666667,0.5739130,1.1478261,1.2333333,0.9500000,1.0000000,1.0166667,0.4916667,0.5327869,1.0000000,1.0000000,1.1353383,1.0601504,1.1205674,0.4503311,0.4177215,1.0687500,1.0375000,1.0687500,1.0000000,1.0000000,0.4637681);
//		List<Double> expectedSeason = asList(1.1967439, 1.2769776, 1.1367740, 0.9786810, 0.6308613, 0.6486807, 1.1430001);
//		List<Double> expectedResidual = asList(0.8516680764003858, 0.7325475746851645, 2.0954761586786432, 1.0754692501660843, 1.5438233025661638, 0.637052123277434, 0.8453752341052131, 0.8705940336537277, 1.5697448028967813, 1.533275238057544, 0.9175097040479405, 0.9616732655568395, 0.9577499535182332, 0.6916706460860834, 0.479063292975217, 0.9810905018104883, 1.5811900892468422, 0.8738187657599434, 1.2020915819460494, 0.7818366967495781, 1.042493978596092, 0.836183202284015, 1.4746087542363702, 2.622707644045799, 0.7793518721642739, 0.9492427063075736, 2.0903726870767985, 0.8778896661861828, 0.5524333468543042, 1.2034710155541988, 1.8910394602709708, 0.9362343918856537, 0.445993398519114, 0.8600203664245359, 0.8193636884404374, 1.1816894560055353, 0.8829814516294394, 1.8794986789092476, 0.8738187657599434, 0.43160651469591677, 0.7818366967495781, 0.9628467306558135, 0.8241949126455346, 1.2465620493592087, 1.6759054927605714, 0.9532568353744837, 0.8172322217182628, 0.7818366967495781, 0.9391377824317304, 0.5941870300467808, 1.1059565656772776, 1.3629113227178171, 0.9830461114799364, 0.9616732655568395, 0.9382040360994938, 0.6737292787010241, 0.6892569548542656, 0.9491480203561933, 1.533275238057544, 1.4428170318361857, 0.8362376222233388, 0.9272946868425229, 0.6350691202197919, 1.034860429986319, 0.9895147770950695, 1.514223408008064, 0.8920233233799423, 0.8536592393529916, 0.781836696749578, 1.529926852676812, 0.7665012687603472, 1.0791995519915372, 1.533275238057544, 1.0291643241172668, 0.8919867970382279, 0.5212244644997188, 1.2588482407845527, 0.4348943368853033, 0.8072973272040589, 2.4852169990961475, 0.8738187657599434, 0.6227301442088692, 0.8650108134250651, 0.9339251767938116, 0.5518809135074499, 0.8310413662394724, 1.653532119473822, 0.993754674785818, 0.8362376222233388, 0.7818366967495781, 0.8951031890525786, 0.7414522076897476, 1.1080551549859634, 1.4055023015527488, 0.92843243861994, 2.1356184828682214, 0.781836696749578, 0.9295302347853701, 0.6624085038669667, 1.075565883466313, 1.7036391533972712, 1.1796553337759237, 1.1916386116682578, 0.7818366967495781, 0.76815345791291, 0.5621009304242546, 1.334283082462264, 1.7036391533972712, 1.1184880201727276, 0.7526138600010048, 0.7818366967495781, 1.0359098060996956, 0.5927609811746685, 0.6447166154754638, 1.6427948979187974, 0.8738187657599434, 0.866103251588458, 0.7399525879951364, 2.5666672051071244, 0.6519665964168471, 0.8292991411530165, 1.8339174415982389, 1.2678938954163885, 0.590285380392945, 0.7818366967495781, 0.8951031890525786, 0.6011774656943899, 0.9358094017269272, 1.5332752380575438, 1.0125201571504105, 0.8495112352745028, 1.0176287164042128, 0.8641726401520238, 0.5908447280027677, 1.0145911530918221, 1.624541621275255, 0.9258317875313686, 0.8362376222233388, 0.8935276534280893, 0.7420257892764165, 0.739606487400335, 1.3012358234539108, 2.138515463606575, 0.8738187657599434, 1.1223189140365861, 1.1624677201671358, 0.7295139479575322, 0.705325111159756, 1.105454086547029, 1.533275238057544, 1.1815014297599236, 1.1660214732409935, 1.1011784461261662, 0.7509658590267347, 0.8348746213727725, 1.0170177596232666, 1.928209769072366, 0.8738187657599434, 2.5449510973263942, 0.7226066439655192, 0.8911910247647613, 0.8847178823502514, 1.0777352378097305, 1.8994305187877039, 0.8974354891588608, 2.269821248966784, 0.7078791713813748, 0.8778896661861828, 0.6767308498965227, 1.0182128451222363, 1.533275238057544, 0.9970496173414738, 0.9220055834770146, 1.5014732724990303, 0.8453752341052132, 0.6182479369425022, 1.1821534935395512, 1.592247362598219, 1.1267663032167692, 2.5333521680837623, 0.7818366967495781, 0.7508266881855511, 0.6185799712802801, 0.7642178645681699, 1.7722272232093692, 1.1915710442181047, 0.8362376222233388, 0.691970409766868, 0.6611267856463846, 1.3473433211151578, 0.9785422147927987, 1.533275238057544, 0.8090914497777254, 0.9882808262639458, 0.9239888234313195, 0.8778896661861828, 0.5771303670666144, 0.5355599915765489, 1.533275238057544, 1.0485825189119322, 0.9346185189554962, 0.8646194058171804, 0.7781294768468439, 0.5342281570147874, 1.0346045291819694, 1.7298489865264601, 1.140226926052609, 1.1625742552861051, 0.676956164258781, 0.8778896661861829, 0.6107083279553985, 0.8941584320298122, 1.7202600231865128, 1.005907648956214, 0.7681717692516716, 1.6428352681574894, 0.9556773581267306, 0.6338997834473756, 0.803125247993702, 1.3728162015166383, 1.0667397919666843, 1.086022886004336, 0.9239888234313195, 0.6983213253753727, 0.5922964349511773, 0.6600063375816012, 1.533275238057544, 0.8936782831635784, 0.9977835265164837, 0.7845252382965495, 0.7496585913499988, 0.5511919236029462, 1.56436534037, 1.573121897099459, 0.9698428059533438, 2.3360059051774047, 0.6443709039144875, 0.8874319451664675, 0.6677077718979024, 0.753477505390455, 1.659544963544636, 0.7710165580234796, 1.2002469401323212, 0.7818366967495781, 0.8882177799060202, 0.7249081766570725, 0.8213780945390134, 1.6045903654090579, 1.0262290156017941, 0.8362376222233388, 0.7000165773222967, 1.0717094626168986, 0.5972737159171536, 0.9173833263682487, 1.141800709191788, 3.3246844186505498, 1.2304639298429125, 1.1727550451243671, 0.6431052205782503, 0.33215054979615044, 0.9418468817380687, 1.806324253054093, 0.9576096063122668, 0.9851566508384538, 0.7818366967495781, 0.853837894509849, 0.5880009732956087, 1.2471945009316892, 1.7414978012505438, 0.9277581957451251, 0.9291529135814874, 0.7818366967495781, 0.8664885016902584, 0.9821834439526526, 1.019314807075832, 1.5534499122425118, 0.9543020731325699, 0.8692470020479443, 0.7818366967495781, 0.8203231306985643, 0.5361320349799149, 1.1837419825123268, 1.533275238057544, 0.9986500180113639, 1.2078987876559335, 0.8578485978224538, 0.7502698384755472, 0.524811679511589, 1.5697448028967813, 1.5391779856324446, 1.003710744453989, 0.7232325381391037, 0.9086210259522124, 0.9019414378625167, 0.6020009964693137, 0.8999870203274879, 1.533275238057544, 1.033813751039933, 0.9893515530529642, 0.781836696749578, 0.8407957366290202, 0.5613812109230711, 1.4682075185025325, 1.554279008441894, 0.9097291259966535, 0.8362376222233388, 1.9659937055364056, 0.8418120086716822, 0.6440010659904286, 0.9866967332494053, 1.91659404757193, 1.1234812702627843, 0.8495112352745028, 0.7694265904519658, 0.8778896661861828, 0.6164454648231363, 0.9966633669185911, 4.036502492087329, 0.9576096063122668, 0.8362376222233388, 0.835387155431056, 0.864979524036386, 0.5338814807286, 1.1948803723542663, 1.5561599431031792, 0.9292993223161303, 0.9424265266326515, 0.7818366967495782, 0.7524768567310138, 0.8760014500118254, 1.1837419825123268, 2.2622093676258848, 1.20329141514484, 0.8362376222233386, 0.884372656979031, 0.7524768567310138, 0.6387510573002892, 1.3174643881455128, 1.533275238057544, 1.1195802936299275, 0.979965963542975, 0.7581446756359546, 0.7725429062438409, 0.6103621214202763, 1.9891095396744478, 1.6099389999604212, 0.786436889183949, 0.8362376222233388, 1.8083958807718814, 0.7437676338521827, 0.5460009037744938, 1.1611810870743313, 1.777710420936283, 0.9244749260938532, 1.0907447246391375, 0.7389963298043957, 0.7095272644518464, 0.535334219451671, 2.1911936891569264, 1.4804036781245253, 1.0043893859309694, 0.9035211090688947, 0.7909278211303872, 0.8677989803679508, 0.7130244360561369, 0.9856537134468161, 1.7497376246068443, 0.9634412032737837, 0.911284588320305, 0.7818366967495781, 0.6086701685557534, 0.9129881779012134, 0.946463778217177, 1.691112394916409, 0.9204224332671405, 0.7581887774824938, 0.8339591431995499, 0.8778896661861828, 0.7364423954756276, 0.8790570896221975, 4.828666021269229, 0.7703402277094239, 0.8362376222233388, 2.6773617049165885, 0.9587479249138575, 0.6723695340003045, 0.7848724014483907, 1.7708249228270228, 0.8738187657599435, 0.9346185189554962, 0.781836696749578, 0.6713273917894339, 0.5206423712334434, 2.1833139157876933, 1.5627613003278815, 0.9648415538599376, 0.8362376222233386, 0.6841071096558808, 0.8778896661861829, 0.715401184176324, 1.255795842317425, 2.299912857086316, 0.9986500180113639, 0.8362376222233388, 0.5105872305303367, 1.0928830538236154, 0.8968586273930592, 1.197262985260257, 1.8349031537409952, 0.8592551196639443, 0.9059240907419503, 0.9903264825494656, 0.8778896661861829, 0.6706886101653038, 0.797330693534873, 1.5576129402489336, 0.8738187657599434, 0.823171409376099, 1.0628092596439578, 1.028776952561933, 0.6132010150082777, 0.9156844683564558, 1.7172682666244494, 1.2015008029199221, 1.8690294132268472, 0.7818366967495781, 0.8535038421254556, 0.6387510573002892, 1.1555065910212416, 1.592247362598219, 0.8738187657599434, 0.9950169175822005, 0.7719400297021151, 0.9566746362285325, 0.5574554681893433, 0.8843632692376232, 1.5777179985809513, 1.1030171305494367, 0.9459081300559077, 0.7690197017208965, 0.8778896661861829, 0.7539356741905054, 0.9264067689226906, 2.4833779731661942, 0.9401847479695593, 0.889164054009626, 0.7818366967495781, 0.6111890081043044, 0.657001087508869, 1.177308602172586, 2.8748910713578955, 0.7196154541552476, 1.0084041915046142, 0.7818366967495781, 1.0457215141335412, 0.4542229740802057, 1.0077374043287979, 1.5689328017333009, 0.995746965633424, 0.8647457229809525, 0.7640676809143605, 0.7758094724436034, 1.551304129839939, 0.7749373077591706, 1.5937992606124471, 0.8623211504209969, 0.9254363019271615, 0.7818366967495781, 0.8544792750878846, 0.47065867380021315, 2.3671152646113933, 1.1549345949004879, 0.8738187657599434, 0.8905387665235555, 1.0340420827978292, 0.8373716815929744, 0.6446472209061381, 1.1591961621391615, 1.533275238057544, 0.9845845247999362, 0.9069055902985504, 0.9580252481297646, 0.8094826792106361, 0.5043644712189297, 0.6954565582454094, 1.533275238057544, 0.9623067420394313, 0.9420904857959131, 0.8610100331292821, 0.7047846615860904, 0.6045643809940766, 0.8843632692376232, 1.533275238057544, 1.0091991379199345, 2.0483752734578298, 0.7818366967495781, 0.6958881500256328, 1.4738562612397381, 1.2515532887960823, 1.533275238057544, 0.8738187657599434, 0.9492427063075736, 0.8346635005840091, 0.8541629184514211, 0.6209630531729394, 1.4647549055284526, 1.6847759031922702, 1.0839777094237273, 0.8362376222233386, 0.702663360369874, 0.8778896661861828, 0.6080263228985032, 0.9935093689220135, 1.5524411785332632, 0.9493339677391978, 0.9910964411535865, 0.7721843918514352, 0.9421254954193182, 0.39882992846066845, 0.9026032616656492, 1.5716071190089826, 1.2790680484312213, 0.9695508663459, 0.781836696749578, 0.0, 0.5924647488002683, 1.0919963846238478, 3.7296650578894712, 0.8738187657599434, 0.7317079194454214, 0.8570133022062683, 0.965678632804801, 0.6745211165091055, 0.926149433709101, 1.5971617063099417, 0.9102278809999411, 0.8108970882165708, 0.7265553141511231, 0.9053237182545011, 1.248278189143995, 0.9830725028242467, 1.0221834920383626, 1.019455226719934, 0.9621228556763144, 0.7818366967495781, 0.9044923833433398, 0.47486947290203324, 0.7769443973933563, 1.4881789075264398, 1.0223679559391339, 0.9198613844456726, 0.8365652655220486, 0.8204576319497036, 0.4249908024809846, 0.6527651655610377, 1.6243608957639328, 0.8652519151152381, 0.8936264786504307, 0.7818366967495781, 1.086497111616563, 0.6111970901226298, 0.8415126778415735, 1.533275238057544, 0.9830461114799365, 0.8362376222233386, 0.806017213143895, 0.8778896661861828, 0.4897091439302218, 1.6598743169964383, 1.2777293650479533, 0.8263712813554513, 0.947349343483371, 0.9854400031947806, 0.9016164139209445, 0.4051177876931565, 0.6080993380591135, 1.719126782064519, 0.8644228650528473, 2.3129541352087273, 0.8322777739592283, 0.8874319451664675, 0.46154915108149935, 0.810190866011242, 1.5003015770240484, 1.2195053104561848, 0.8821847443235222, 0.9086556868971348, 0.7407194058445917, 0.3938964853351784, 1.3506591210885943, 1.533275238057544, 0.9820794978009985, 2.7835878732612978, 0.8787014202406763, 0.8778896661861828, 0.4887834177602214, 0.6278979211587126, 1.4310568888537079, 0.9135378005672136, 0.8552430227284146, 0.9772958709369727, 0.8583810069376009, 0.4996452714882263, 0.7426749605103051, 1.533275238057544, 0.9395900707096166, 0.8632130293918335, 0.849091466362445, 0.7498640898673645, 0.5429383987052459, 0.80401563075201, 2.000737200879966, 2.1054569840535127, 0.6413861374334345, 0.8881057623271906, 0.8778896661861829, 0.45642793997379894, 0.5486486689736323, 1.5788180669107383, 1.0810129060947753, 0.8707216478820331, 0.7818366967495781, 0.7577573960764946, 0.4625902393922095, 0.7766105866963023, 1.533275238057544, 1.26013864114855, 3.141462186401785, 0.8723651563732134, 0.6956861505626355, 0.5013593204470195, 0.8008902055595822, 1.6755378890113368, 1.176980378370536, 0.8362376222233388, 0.7738587712725415, 0.9764283021866728, 0.6674296761994859, 0.6705705954122172, 1.4759565375694117, 0.9586555391346953, 0.9011881171533067, 0.8121992869146102, 0.7794347503522184, 0.47757088396283315, 0.7775371453600879, 1.533275238057544, 2.5600381131277548, 0.9171638437288231, 0.9079393897737036, 0.6261418942651451, 0.4568037864329341, 0.7912534778829303, 3.739235538469332, 1.1198454085467238, 0.9986138595482588, 0.781836696749578, 0.740181483255017, 0.4609027236990323, 0.7387034366573089, 1.533275238057544, 1.0391358295523652, 0.8437712944956209, 0.8804467305738491, 0.8700513655952348, 0.4653757703187822, 0.7984046842319835, 1.5332752380575443, 0.888884606548908, 1.0525059727983401, 0.8559763835103139, 0.8778896661861828, 0.5677787176002571, 0.6342403244027399, 1.3783989513850647, 0.9720006495531954, 2.5597656433031677, 0.9223916085247832, 0.6562003565432073, 0.37960062833845765, 0.5078586127018998, 1.6986284500049262, 0.9487175171107958, 0.8123451187312433, 0.8637433983138196, 0.8778896661861828, 0.5840009666745503, 0.9472597948515059, 1.533275238057544, 2.2955769702626587, 0.8854280705894175, 0.9066677659785023, 0.8012485048524685, 0.6813344611203086, 0.9008970173146745, 1.7599333167269202, 1.07770981110393, 0.7944257411121718, 0.7818366967495781, 0.8925211606226193, 0.5024841650762276, 0.8363394441663179, 1.533275238057544, 0.8738187657599434, 0.9494126387648432, 0.8288644679826355, 0.9837345195561482, 0.46023917241239387, 0.6557161834885289, 1.6386879106740002, 0.9065869694759413, 0.8937289587511933, 0.7818366967495781, 0.8778896661861828, 0.47397179904021464);
//		
		Serie serie = new Serie(webTraffic, 7)
						.multiplicative();
					
		
		assertThat(serie.trend(), closeTo(expectedMA, 0.0001));
//		assertThat(serie.detrend(), closeTo(expectedDetrend, 0.0001));
//		assertThat(serie.season(), closeTo(expectedSeason, 0.01));
//		assertThat(serie.residual(), closeTo(expectedResidual, 0.01));

	}
}